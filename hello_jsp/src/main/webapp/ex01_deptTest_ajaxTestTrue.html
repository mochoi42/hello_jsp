<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script>
    window.onload = function(){
        document.querySelector("#btnRead").onclick=function(){
            let request = new XMLHttpRequest();
            //비동기 방식의 get방식으로 jsp

            //textarea를 쓰다가 버튼을 누르면 textarea는 작성이된다.

            //하지만 아래를 true 를 할 경우 아무리 기다려도 문장이 실행이 안된다.            
            request.open("get", "listDept_ajaxTest.jsp", true);
            request.send();

            //서버로부터 응답이 오기도 전에 동작하기 때문에 노드가 생성되지 않기 때문이다.
            //즉, 서버로부터 응답이 된 후 동작하게끔 코드를 변경해줘야한다.
            //상태를 판별하는 이벤트 필요
            let arr = eval("("+request.responseText+")");
            let table = document.createElement("table");
            for(let i=0;i<arr.length;i++){
                let tr = document.createElement("tr");
                let td1 = document.createElement("td");
                let td2 = document.createElement("td");
                let td3 = document.createElement("td");
                let txt1 = document.createTextNode(arr[i].dno);
                let txt2 = document.createTextNode(arr[i].dname);
                let txt3 = document.createTextNode(arr[i].dloc);

                td1.appendChild(txt1);
                td2.appendChild(txt2);
                td3.appendChild(txt3);

                tr.appendChild(td1);
                tr.appendChild(td2);
                tr.appendChild(td3);

                table.appendChild(tr);
            }
            document.querySelector("#output").appendChild(table);
        }
    }
</script>
<style>
    table{
        border:1px solid #ddd;
        border-spacing: 0;
        border-collapse: separate;
    }
    table td{
        border:1px solid #ddd;
    }
</style>
</head>
<body>
    <textarea name="" id=""></textarea>
    <hr>
    <h1>Hello Kosta</h1>
    <button id="btnRead">Ajax 통신</button>
    <hr>
    <div id="output"></div>
    <h1>Hello Kosta</h1>
</body>
</html>